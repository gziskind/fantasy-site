#! /usr/bin/env ruby

require 'trollop'
require_relative '../fantasy_server'

options = Trollop::options do
	opt :database, "Database", :default => "test_database"
	opt :port, "Server port", :default => 8080
	opt :db_host, "Database Host", :default => "localhost", :short => "h"
	opt :db_port, "Database Port", :default => 27017, :short => "P"
	opt :db_user, "Database User", :short => "u", :type => :string
	opt :db_password, "Database Password", :type => :string
	opt :dropbox_token, "Dropbox Token", :short => 't', :type => :string
	opt :ga_token, "Google Analytics Token", :short => 'g', :type => :string
	opt :redis_host, "Redis Host", :type => :string
	opt :redis_port, "Redis Port", :type => :integer
	opt :redis_password, "Redis Password", :type => :string
	opt :espn_user, "Espn User", :type => :string, :short => 'U'
	opt :espn_password, "Espn Password", :type => :string, :short => 'w'
	opt :espn_football_id, "Espn Football League ID", :type => :string, :short => 'f'
	opt :espn_baseball_id, "Espn Baseball League ID", :type => :string, :short => 'b'
	opt :api_token, "API Token", :type => :string, :short => 'a'
end

port = ENV["PORT"] || options[:port]
database = ENV["DATABASE"] || options[:database]
db_host = ENV["DB_HOST"] || options[:db_host]
db_port = ENV["DB_PORT"] || options[:db_port]
db_user = ENV["DB_USER"] || options[:db_user]
db_password = ENV["DB_PASSWORD"] || options[:db_password]
dropbox_token = ENV['DROPBOX_TOKEN'] || options[:dropbox_token]
ga_token = ENV['GA_TOKEN'] || options[:ga_token]
redis_host = ENV["REDIS_HOST"] || options[:redis_host]
redis_port = ENV["REDIS_PORT"] || options[:redis_port]
redis_password = ENV["REDIS_PASSWORD"] || options[:redis_password]
espn_user = ENV["ESPN_USER"] || options[:espn_user]
espn_password = ENV["ESPN_PASSWORD"] || options[:espn_password]
espn_football_id = ENV["ESPN_FOOTBALL_ID"] || options[:espn_football_id] 
espn_baseball_id = ENV["ESPN_BASEBALL_ID"] || options[:espn_baseball_id] 
api_token = ENV["API_TOKEN"] || options[:api_token]

FantasyServer.set :bind, '0.0.0.0'
FantasyServer.set :port, port
FantasyServer.set :database, database
FantasyServer.set :db_host, db_host
FantasyServer.set :db_port, db_port
FantasyServer.set :db_user, db_user
FantasyServer.set :db_password, db_password
FantasyServer.set :dropbox_token, dropbox_token
FantasyServer.set :ga_token, ga_token
FantasyServer.set :redis_host, redis_host
FantasyServer.set :redis_port, redis_port
FantasyServer.set :redis_password, redis_password
FantasyServer.set :espn_user, espn_user
FantasyServer.set :espn_password, espn_password
FantasyServer.set :espn_football_id, espn_football_id
FantasyServer.set :espn_baseball_id, espn_baseball_id
FantasyServer.set :api_token, api_token
FantasyServer.start

